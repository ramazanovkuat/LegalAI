# Legal AI - сервис юридической помощи

## Обоснование проекта

Сложность российских гражданско-правовых документов существенно ограничивает возможности неспециалистов в получении доступа к важной правовой информации и ее понимании. Этот барьер не только подрывает прозрачность и правосудие, но и влияет на осознанную гражданскую позицию. Разработка модели генерации данных с расширенным поиском (RAG), специально адаптированной к российским правовым документам, может восполнить этот пробел. Упрощая процесс юридических исследований, модель RAG направлена на то, чтобы сделать юридические знания более доступными не только для широкой общественности, но и для юристов-профессионалов и бизнеса, тем самым расширяя правовые возможности общества.

## Предварительная обработка данных

Для эффективного обучения модели RAG данные были тщательно проанализированы, структурированы и снабжены комментариями, гарантируя, что выходные данные модели будут точными и юридически обоснованными. Были ипользованы следующие нормативно-правовые акты Российской Федерации:

- Гражданский кодекс;
- Гражданский Процессуальный кодекс;
- Жилищный кодекс;
- Налоговый кодекс;
- Земельный кодекс;
- Трудовой кодекс;
- Ряд федеральных законов. 

Предварительно обработанный набор данных был проанализирован и разделен на статьи и их метаданные (название статьи, раздела, подраздела и т.д.) в соответствии с иерархией документа. Разбиение данных было выполнено на блоки размером 100 токенов с перекрытием 30 элементов, и для каждого из них был собран текст статьи и метаданные. Векторизация произведена моделью RuBert, и с помощью FAISS (Facebook AI Similarity Search) были выбраны пять наиболее близких векторов для точной настройки. Пример запроса и коррелирующих статей на основе FAISS:

**Вопрос: Может ли частное представительство принимать участие в деятельности компании?**

**Выделенные документы: Гражданский кодекс Статья 303, Гражданский кодекс Статья 228, Налоговый кодекс Статья 275.1, Гражданский кодекс Статья 635, ФЗ ООО Статья 15.**

## Архитектура модели
Модель RAG объединяет механизм поиска с генеративной моделью NLP для предоставления точной и соответствующей контексту правовой информации. Более классические подходы предполагают использование архитектуры End2End, которая обновляет как генераторную, так и поисковую подготовку. Из-за некоторых вычислительных ограничений мы использовали несколько более простую архитектуру, в которой весь поисковый модуль заморожен. Точнее, в нашем проекте мы сравнили два конвейера настройки: с дополнительным поиском информации и без него.
Мы сравнили два конвейера тонкой настройки: с извлечением дополнительной информации и без него. В первой настройке (без извлечения) мы настраивали модель phi-3b на основе набора данных с ответами на вопросы. Во втором случае мы дополняем обучающие пары "вопрос-ответ" 5-ю найденными документами из нашего индекса FAISS. 

## Создание окружения

```
conda env create -f environment.yml
conda activate legal
```